<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>본인인증서비스</title>
    </meta>
</head>
<body onload="openKMCISWindow()">
<h2>본인인증서비스</h2>

<form name="reqKMCISForm" method="post" action="#">
    <input type="hidden" name="tr_cert" th:value="${cert}"/>
    <input type="hidden" name="tr_url" th:value="${callbackUrl}"/>
</form>

<script th:inline="javascript">
  document.domain = [[${domain}]];
  window.name = "kmcis_web";
  function openKMCISWindow() {
    var userAgent = navigator.userAgent;

    if (userAgent.match(/iPhone|iPod|Android|Windows CE|BlackBerry|Symbian|Windows Phone|webOS|Opera Mini|Opera Mobi|POLARIS|IEMobile|lgtelecom|nokia|SonyEricsson/i) != null || userAgent.match(/LG|SAMSUNG|Samsung/) != null) {
      document.reqKMCISForm.target = '';
    } else {
      var popupWindow = window.open('', 'KMCISWindow', 'width=425, height=550, resizable=0, scrollbars=no, status=0, titlebar=0, toolbar=0, left=435, top=250');
      if (popupWindow == null) {
        alert(" ※ 윈도우 XP SP2 또는 인터넷 익스플로러 7 사용자일 경우에는 \n    화면 상단에 있는 팝업 차단 알림줄을 클릭하여 팝업을 허용해 주시기 바랍니다. \n\n※ MSN,야후,구글 팝업 차단 툴바가 설치된 경우 팝업허용을 해주시기 바랍니다.");
      }
      document.reqKMCISForm.target = 'KMCISWindow';

      var interval = window.setInterval(function () {
        try {
          if (popupWindow == null || popupWindow.closed) {
            window.clearInterval(interval);
            window.opener.handleCertResult("F", "");
          }
        }
        catch (e) {
        }
      }, 1000);
    }

    document.reqKMCISForm.action = 'https://www.kmcert.com/kmcis/web/kmcisReq.jsp';
    document.reqKMCISForm.submit();
  }
</script>
</body>
</html>
